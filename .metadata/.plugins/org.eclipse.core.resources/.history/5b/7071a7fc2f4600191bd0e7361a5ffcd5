package com.nt.dao;

import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.util.List;

import javax.sql.DataSource;

import com.nt.bo.BankBO;

public class BankDAOImpl implements BankDAO {
	private DataSource ds;
	private static final String DEBIT="UPDATE BANKACCOUNT SET BALANCE=BALANCE+? WHERE ACNO=?";
	private static final String CREDIT="UPDATE BANKACCOUNT SET BALANCE=BALANCE-? WHERE ACNO=?";
	private static final String GET_ACC_DETAILS="SELECT ACNO,HOLDERNAME,ADDRS,BALANCE FROM BANKACCOUNT WHERE ADDRS=?";

	@Override
	public String deposit(int accno, int amount) throws Exception {
		int count=0;
		try(Connection con=ds.getConnection()){
			try(PreparedStatement ps=con.prepareStatement(DEBIT)){
				//set values to query param
				ps.setInt(1,amount);
				ps.setInt(2, accno);
				count=ps.executeUpdate();
			}//try2
			catch(SQLException se) {
				se.printStackTrace();
			}
			catch(Exception e) {
				e.printStackTrace();
			}
		}//try1
		if(count==0)
			return "Amount Not Deposited";
		else
			return "Amount Deposited";
	}

	@Override
	public String moneyTransfer(int srcAccno, int targetAccno, int amount) throws Exception {
		// TODO Auto-generated method stub
		return null;
	}

	@Override
	public String withdraw(int accno, int amount) throws Exception {
		// TODO Auto-generated method stub
		return null;
	}

	@Override
	public List<BankBO> getAccDetails(String addrs) throws Exception {
		// TODO Auto-generated method stub
		return null;
	}

}
